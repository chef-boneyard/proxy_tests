sudo: required
dist: trusty
os:
  - linux
  #- osx

addons:
  apt:
    sources:
      # later we can test with current, now we want stable
      #- chef-current-precise
      - chef-stable-precise
    packages:
      - chefdk
      #- git
      #- squid

before_install:
  - sudo apt-get -y install squid3 git curl wget

# Ensure we make ChefDK's Ruby the default
before_script:
  - eval "$(/opt/chefdk/bin/chef shell-init bash)"

env:
  PROXY_TESTS_DIR=/tmp/proxy_tests

script:
  - chef-client --version
  - chef-client -z -o proxy_tests::render
  #- sh /tmp/proxy_tests/setup.sh
  - sudo -E bash /tmp/proxy_tests/run_tests.sh \* \* \* /tmp/out.txt

after_script:
  - cat /tmp/out.txt
